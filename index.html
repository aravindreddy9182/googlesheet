<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="container">
        <div class="toolbar">
            <div class="toolbar-section">
                <img src=sheet.png alt="Google Sheets" style="width: 30px; height: 30px;">
                <button id="btnAddRow">Add Row</button>
                <button id="btnDeleteRow">Delete Row</button>
                <button id="btnAddColumn">Add Column</button>
                <button id="btnDeleteColumn">Delete Column</button>
            </div>
            
            <div class="toolbar-section">
                <select id="fontFamily">
                    <option value="Arial">Arial</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                </select>
                
                <select id="fontSize">
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12" selected>12</option>
                    <option value="14">14</option>
                    <option value="16">16</option>
                </select>
                
                <button id="btnBold" title="Bold">B</button>
                <button id="btnItalic" title="Italic">I</button>
                <button id="btnColor" title="Text Color">A</button>
                <input type="color" id="colorPicker" class="hidden">
            </div>
            
            <div class="toolbar-section">
                <button id="btnFunction" title="Insert Function">fx</button>
                <button id="btnDataValidation" title="Data Validation">✓</button>
                <button id="btnFindReplace" title="Find and Replace">⌕</button>
                <button id="btnRemoveDuplicates" title="Remove Duplicates">⧉</button>
                <button id="btnCreateChart">Create Chart</button>
            </div>
            
            <div class="toolbar-section">
                <button id="btnSave">Save</button>
                <button id="btnLoad">Load</button>
                <input type="file" id="loadInput" class="hidden" accept=".json">
            </div>
        </div>
        
        <div class="formula-bar">
            <div class="cell-address" id="cellAddress">A1</div>
            <input type="text" class="formula-input" id="formulaInput" placeholder="Enter formula...">
        </div>
        
        <div class="spreadsheet">
            <table class="grid" id="grid">
                <thead>
                    <tr>
                        <th></th>
                        <!-- Column headers generated by JS -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Rows generated by JS -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Function Dialog -->
    <div id="functionDialog" class="dialog hidden">
        <h3>Insert Function</h3>
        <div>
            <label for="functionType">Function:</label>
            <select id="functionType">
                <option value="SUM">SUM</option>
                <option value="AVERAGE">AVERAGE</option>
                <option value="MAX">MAX</option>
                <option value="MIN">MIN</option>
                <option value="COUNT">COUNT</option>
                <option value="TRIM">TRIM</option>
                <option value="UPPER">UPPER</option>
                <option value="LOWER">LOWER</option>
                <option value="POWER">POWER</option>
                <option value="ROUND">ROUND</option>
                <option value="IF">IF</option>
                <option value="ISNUMBER">ISNUMBER</option>
                <option value="ISTEXT">ISTEXT</option>
            </select>
        </div>
        <div style="margin-top: 10px;">
            <label for="functionRange">Range or Parameters:</label>
            <input type="text" id="functionRange" placeholder="e.g., A1:B5 or value1,value2">
        </div>
        <div class="dialog-buttons">
            <button id="cancelFunction">Cancel</button>
            <button id="applyFunction" class="primary">Apply</button>
        </div>
    </div>
    
    <!-- Find and Replace Dialog -->
    <div id="findReplaceDialog" class="dialog hidden">
        <h3>Find and Replace</h3>
        <div>
            <label for="findText">Find:</label>
            <input type="text" id="findText">
        </div>
        <div style="margin-top: 10px;">
            <label for="replaceText">Replace with:</label>
            <input type="text" id="replaceText">
        </div>
        <div style="margin-top: 10px;">
            <label for="searchRange">Range:</label>
            <input type="text" id="searchRange" placeholder="e.g., A1:B5">
        </div>
        <div class="dialog-buttons">
            <button id="cancelFindReplace">Cancel</button>
            <button id="applyFindReplace" class="primary">Replace All</button>
        </div>
    </div>
    
    <!-- Data Validation Dialog -->
    <div id="dataValidationDialog" class="dialog hidden">
        <h3>Data Validation</h3>
        <div>
            <label for="validationType">Type:</label>
            <select id="validationType">
                <option value="number">Number only</option>
                <option value="text">Text only</option>
                <option value="date">Date only</option>
            </select>
        </div>
        <div style="margin-top: 10px;">
            <label for="validationRange">Apply to range:</label>
            <input type="text" id="validationRange" placeholder="e.g., A1:B5">
        </div>
        <div class="dialog-buttons">
            <button id="cancelValidation">Cancel</button>
            <button id="applyValidation" class="primary">Apply</button>
        </div>
    </div>
    
    <!-- Chart Dialog -->
    <div id="chartDialog" class="dialog hidden">
        <h3>Create Chart</h3>
        <div>
            <label for="chartRange">Range:</label>
            <input type="text" id="chartRange" placeholder="e.g., A1:B5">
        </div>
        <div style="margin-top: 10px;">
            <label for="chartType">Type:</label>
            <select id="chartType">
                <option value="bar">Bar</option>
                <option value="line">Line</option>
            </select>
        </div>
        <div class="dialog-buttons">
            <button id="cancelChart">Cancel</button>
            <button id="applyChart" class="primary">Create</button>
        </div>
    </div>
    
    <!-- Chart Container -->
    <div id="chartContainer" class="hidden" style="position: absolute; background: white; border: 1px solid #ccc; padding: 10px; z-index: 1000;">
        <canvas id="chartCanvas"></canvas>
        <button id="closeChart" style="position: absolute; top: 5px; right: 5px;">X</button>
    </div>
    
    <!-- Overlay -->
    <div id="overlay" class="overlay hidden"></div>

    <script src="./script.js"></script>
</body>
</html>
